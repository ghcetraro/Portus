<VirtualHost *:443>

  ServerName ${PORTAL_URL}
  ServerAlias ${PORTAL_URL}
  SSLEngine on
  SSLCertificateFile /etc/apache2/ssl/linux.crt
  SSLCertificateKeyFile /etc/apache2/ssl/linux.key

  # Anti CRIME
  SSLCompression off

  # POODLE and other stuff
  SSLProtocol all -SSLv2 -SSLv3 -TLSv1

  # Secure cypher suites
  SSLCipherSuite EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH
  SSLHonorCipherOrder on

  #Header always set "Docker-Distribution-Api-Version" "registry/2.0"
  #Header onsuccess set "Docker-Distribution-Api-Version" "registry/2.0"
  RequestHeader set X-Forwarded-Proto "https"

  ProxyRequests     off
  ProxyPreserveHost on

  # no proxy for /error/ (Apache HTTPd errors messages)
  ProxyPass /error/ !

  ProxyPass        / http://${BACK_IP}:3000/
  ProxyPassReverse / http://${BACK_IP}:3000/

  </VirtualHost>
